(()=>{"use strict";var e=()=>{};function r(e){return{tag:0,0:e}}function t(e){return{tag:1,0:e}}function n(r){return t=>n=>{var i=e;t((e=>{0===e?n(0):0===e.tag?(i=e[0],n(e)):r(e[0])?n(e):i(0)}))}}function i(e){return r=>n=>r((r=>{0===r||0===r.tag?n(r):n(t(e(r[0])))}))}function a(t){return n=>i=>{var a=e,s=!1,o=0;n((e=>{s||(0===e?(s=!0,i(0)):0===e.tag?t<=0?(s=!0,i(0),e[0](1)):a=e[0]:o++<t?(i(e),!s&&o>=t&&(s=!0,i(0),a(1))):i(e))})),i(r((e=>{1!==e||s?0===e&&!s&&o<t&&a(0):(s=!0,a(1))})))}}function s(e){return n=>{var i=!1,a=e({next(e){i||n(t(e))},complete(){i||(i=!0,n(0))}});n(r((e=>{1!==e||i||(i=!0,a())})))}}function o(r){return t=>{var n=e,i=!1;return t((e=>{0===e?i=!0:0===e.tag?(n=e[0])(0):i||(r(e[0]),n(0))})),{unsubscribe(){i||(i=!0,n(1))}}}}var u=(...e)=>{for(var r=e[0],t=1,n=e.length;t<n;t++)r=e[t](r);return r},c="Invariant failed";function l(e){return s((r=>{function t(e){r.next(e.data)}return e.addEventListener("message",t),e.start(),()=>{e.removeEventListener("message",t)}}))}const d=new Promise((e=>{return u((r=location.origin,t=window,s((e=>{function n(n){n.origin===r&&n.source===t&&e.next(n.data)}return addEventListener("message",n),()=>{removeEventListener("message",n)}}))),i((e=>"object"==typeof e&&null!=e&&"keeperMessagePort"in e&&e.keeperMessagePort instanceof MessagePort?e.keeperMessagePort:void 0)),n((e=>null!=e)),a(1),o((r=>{r&&e(r)})));var r,t})),g=(v=e=>{d.then((r=>r.postMessage(e)))},f=s((e=>(d.then((r=>{u(l(r),o((r=>{e.next(r)})))})),()=>{}))),new Proxy({},{get:(e,r)=>(e[r]||(e[r]=function(e){return async(...r)=>{await new Promise((e=>{let r;!function e(){v("KEEPER_PING"),r=setTimeout(e,1e3)}(),u(f,n((e=>"KEEPER_PONG"===e)),a(1),o((()=>{clearTimeout(r),e()})))}));const t={keeperMethodCallRequest:{id:((e=21)=>crypto.getRandomValues(new Uint8Array(e)).reduce(((e,r)=>e+((r&=63)<36?r.toString(36):r<62?(r-26).toString(36).toUpperCase():r>62?"-":"_")),""))(),method:e,args:r}};return v(t),new Promise(((e,r)=>{u(f,i((e=>"object"==typeof e&&null!=e&&"keeperMethodCallResponse"in e?e.keeperMethodCallResponse:void 0)),i((e=>"object"==typeof e&&null!=e&&"id"in e&&"string"==typeof e.id?"isError"in e&&!0===e.isError?{error:"error"in e?e.error:void 0,id:e.id,isError:e.isError}:{data:"data"in e?e.data:void 0,id:e.id}:void 0)),n((e=>e?.id===t.keeperMethodCallRequest.id)),a(1),o((t=>{!function(e,r){if(!e)throw new Error(c)}(t),t.isError?r(t.error):e(t.data)})))}))}}(r)),e[r])})),p=s((e=>(g.subscribeToPublicState(),d.then((r=>{u(l(r),o((r=>{if("object"==typeof r&&null!=r&&"event"in r)switch(r.event){case"disconnected":g.subscribeToPublicState();break;case"updatePublicState":"publicState"in r&&e.next(r.publicState)}})))})),()=>{})));var v,f;function b(e){Object.defineProperty(window,e,{configurable:!0,get:()=>(console.warn(`${e} global variable is deprecated and will be removed in future releases, please update to use KeeperWallet instead`),KeeperWallet)})}globalThis.KeeperWallet={auth:g.auth,decryptMessage:g.decryptMessage,encryptMessage:g.encryptMessage,getKEK:g.getKEK,notification:g.notification,publicState:g.publicState,resourceIsApproved:g.resourceIsApproved,resourceIsBlocked:g.resourceIsBlocked,signAndPublishCancelOrder:g.signAndPublishCancelOrder,signAndPublishOrder:g.signAndPublishOrder,signAndPublishTransaction:g.signAndPublishTransaction,signCancelOrder:g.signCancelOrder,signCustomData:g.signCustomData,signOrder:g.signOrder,signRequest:g.signRequest,signTransaction:g.signTransaction,signTransactionPackage:g.signTransactionPackage,verifyCustomData:g.verifyCustomData,wavesAuth:g.wavesAuth,get initialPromise(){return console.warn("You don't need to use initialPromise anymore. If KeeperWallet variable is defined, you can call any api right away"),Promise.resolve(globalThis.KeeperWallet)},on:(e,r)=>{"update"===e&&u(p,o((e=>{r(e)})))}},b("WavesKeeper"),b("Waves")})();
//# sourceMappingURL=inpage.js.map